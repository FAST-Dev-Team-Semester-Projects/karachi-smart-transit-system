-- insert_drivers_assignments.sql
-- Purpose: Inserts 250 drivers (with Pakistani CNIC format licenses) and assigns first 50 drivers to first 50 buses for today
-- License format: NNNNN-NNNNNNN-N#NNN (e.g., 42101-1234567-8#001)
-- Usage: Run after insert_buses_master.sql to ensure buses exist before assignments
-- Assignment logic: 1:1 mapping for today (driver 1 -> bus 1, ... driver 50 -> bus 50)
-- Only first 50 drivers and buses are assigned for demonstration/testing

USE ksts_db;

INSERT INTO drivers (full_name, license_number, phone_number) VALUES
('Muhammad Ali', '42101-1000001-1#001', '0300-1000001'), ('Ahmed Hassan', '42101-1000002-3#002', '0300-1000002'),
('Asad Khan', '42101-1000003-5#003', '0300-1000003'), ('Bilal Ahmed', '42101-1000004-7#004', '0300-1000004'),
('Fahad Sheikh', '42101-1000005-9#005', '0300-1000005'), ('Hassan Raza', '42101-1000006-1#006', '0300-1000006'),
('Imran Malik', '42101-1000007-3#007', '0300-1000007'), ('Kamran Ali', '42101-1000008-5#008', '0300-1000008'),
('Nadeem Abbas', '42101-1000009-7#009', '0300-1000009'), ('Rashid Khan', '42101-1000010-9#010', '0300-1000010'),
('Salman Farooq', '42101-1000011-1#011', '0301-1000011'), ('Tariq Jamil', '42101-1000012-3#012', '0301-1000012'),
('Usman Ali', '42101-1000013-5#013', '0301-1000013'), ('Waqar Younis', '42101-1000014-7#014', '0301-1000014'),
('Yasir Arafat', '42101-1000015-9#015', '0301-1000015'), ('Zain Abbas', '42101-1000016-1#016', '0301-1000016'),
('Arif Nizami', '42101-1000017-3#017', '0301-1000017'), ('Babar Azam', '42101-1000018-5#018', '0301-1000018'),
('Danish Ahmed', '42101-1000019-7#019', '0301-1000019'), ('Faisal Malik', '42101-1000020-9#020', '0301-1000020'),
('Hamza Shahid', '42101-1000021-1#021', '0302-1000021'), ('Ibrahim Khan', '42101-1000022-3#022', '0302-1000022'),
('Junaid Akhtar', '42101-1000023-5#023', '0302-1000023'), ('Kashif Abbasi', '42101-1000024-7#024', '0302-1000024'),
('Luqman Hakim', '42101-1000025-9#025', '0302-1000025'), ('Mohsin Raza', '42101-1000026-1#026', '0302-1000026'),
('Nadir Shah', '42101-1000027-3#027', '0302-1000027'), ('Omar Farooq', '42101-1000028-5#028', '0302-1000028'),
('Qasim Ali', '42101-1000029-7#029', '0302-1000029'), ('Rizwan Ahmed', '42101-1000030-9#030', '0302-1000030'),
('Shahid Afridi', '42101-1000031-1#031', '0303-1000031'), ('Talha Siddiqui', '42101-1000032-3#032', '0303-1000032'),
('Uzair Baloch', '42101-1000033-5#033', '0303-1000033'), ('Wahab Riaz', '42101-1000034-7#034', '0303-1000034'),
('Yaseen Shah', '42101-1000035-9#035', '0303-1000035'), ('Zahid Hussain', '42101-1000036-1#036', '0303-1000036'),
('Abdul Razzaq', '42101-1000037-3#037', '0303-1000037'), ('Basit Ali', '42101-1000038-5#038', '0303-1000038'),
('Dawood Khan', '42101-1000039-7#039', '0303-1000039'), ('Ehsan Adil', '42101-1000040-9#040', '0303-1000040'),
('Farhan Ashraf', '42101-1000041-1#041', '0304-1000041'), ('Ghulam Farid', '42101-1000042-3#042', '0304-1000042'),
('Haider Ali', '42101-1000043-5#043', '0304-1000043'), ('Iftikhar Ahmed', '42101-1000044-7#044', '0304-1000044'),
('Junaid Jamshed', '42101-1000045-9#045', '0304-1000045'), ('Khurram Manzoor', '42101-1000046-1#046', '0304-1000046'),
('Liaquat Ali', '42101-1000047-3#047', '0304-1000047'), ('Majid Khan', '42101-1000048-5#048', '0304-1000048'),
('Nasir Jamshed', '42101-1000049-7#049', '0304-1000049'), ('Owais Shah', '42101-1000050-9#050', '0304-1000050'),
('Pervez Ali', '42101-2000001-1#051', '0305-2000051'), ('Qadir Ahmed', '42101-2000002-3#052', '0305-2000052'),
('Raees Khan', '42101-2000003-5#053', '0305-2000053'), ('Saeed Ajmal', '42101-2000004-7#054', '0305-2000054'),
('Tanvir Ahmed', '42101-2000005-9#055', '0305-2000055'), ('Umar Akmal', '42101-2000006-1#056', '0305-2000056'),
('Wasim Akram', '42101-2000007-3#057', '0305-2000057'), ('Yasir Shah', '42101-2000008-5#058', '0305-2000058'),
('Zaheer Abbas', '42101-2000009-7#059', '0305-2000059'), ('Azhar Ali', '42101-2000010-9#060', '0305-2000060'),
('Shoaib Malik', '42101-2000011-1#061', '0306-2000061'), ('Misbah Haq', '42101-2000012-3#062', '0306-2000062'),
('Younis Khan', '42101-2000013-5#063', '0306-2000063'), ('Inzamam Haq', '42101-2000014-7#064', '0306-2000064'),
('Saqlain Mushtaq', '42101-2000015-9#065', '0306-2000065'), ('Mushtaq Ahmed', '42101-2000016-1#066', '0306-2000066'),
('Waqar Hassan', '42101-2000017-3#067', '0306-2000067'), ('Imran Nazir', '42101-2000018-5#068', '0306-2000068'),
('Shahid Nazir', '42101-2000019-7#069', '0306-2000069'), ('Kamran Akmal', '42101-2000020-9#070', '0306-2000070'),
('Salman Butt', '42101-2000021-1#071', '0307-2000071'), ('Mohammad Amir', '42101-2000022-3#072', '0307-2000072'),
('Mohammad Asif', '42101-2000023-5#073', '0307-2000073'), ('Junaid Khan', '42101-2000024-7#074', '0307-2000074'),
('Rahat Ali', '42101-2000025-9#075', '0307-2000075'), ('Wahab Khan', '42101-2000026-1#076', '0307-2000076'),
('Sohail Khan', '42101-2000027-3#077', '0307-2000077'), ('Tanvir Shah', '42101-2000028-5#078', '0307-2000078'),
('Usman Shinwari', '42101-2000029-7#079', '0307-2000079'), ('Hassan Ali', '42101-2000030-9#080', '0307-2000080'),
('Shadab Khan', '42101-2000031-1#081', '0308-2000081'), ('Faheem Ashraf', '42101-2000032-3#082', '0308-2000082'),
('Haris Rauf', '42101-2000033-5#083', '0308-2000083'), ('Shaheen Afridi', '42101-2000034-7#084', '0308-2000084'),
('Naseem Shah', '42101-2000035-9#085', '0308-2000085'), ('Hasnain Ali', '42101-2000036-1#086', '0308-2000086'),
('Iftikhar Shah', '42101-2000037-3#087', '0308-2000087'), ('Khushdil Shah', '42101-2000038-5#088', '0308-2000088'),
('Asif Ali', '42101-2000039-7#089', '0308-2000089'), ('Haider Azam', '42101-2000040-9#090', '0308-2000090'),
('Sohaib Maqsood', '42101-3000001-1#091', '0309-3000091'), ('Umar Gul', '42101-3000002-3#092', '0309-3000092'),
('Sohail Tanvir', '42101-3000003-5#093', '0309-3000093'), ('Abdul Rauf', '42101-3000004-7#094', '0309-3000094'),
('Bilal Asif', '42101-3000005-9#095', '0309-3000095'), ('Fahad Alam', '42101-3000006-1#096', '0309-3000096'),
('Hasan Mohsin', '42101-3000007-3#097', '0309-3000097'), ('Imad Wasim', '42101-3000008-5#098', '0309-3000098'),
('Kamran Khan', '42101-3000009-7#099', '0309-3000099'), ('Nauman Ali', '42101-3000010-9#100', '0309-3000100'),
('Rameez Raja', '42101-3000011-1#101', '0310-3000101'), ('Sarfaraz Ahmed', '42101-3000012-3#102', '0310-3000102'),
('Tabish Khan', '42101-3000013-5#103', '0310-3000103'), ('Umair Masood', '42101-3000014-7#104', '0310-3000104'),
('Wahab Mir', '42101-3000015-9#105', '0310-3000105'), ('Yasir Hameed', '42101-3000016-1#106', '0310-3000106'),
('Zulqarnain Haider', '42101-3000017-3#107', '0310-3000107'), ('Aamer Yamin', '42101-3000018-5#108', '0310-3000108'),
('Bilawal Bhatti', '42101-3000019-7#109', '0310-3000109'), ('Danish Aziz', '42101-3000020-9#110', '0310-3000110'),
('Fawad Alam', '42101-3000021-1#111', '0311-3000111'), ('Hammad Azam', '42101-3000022-3#112', '0311-3000112'),
('Imran Farhat', '42101-3000023-5#113', '0311-3000113'), ('Khalid Latif', '42101-3000024-7#114', '0311-3000114'),
('Mohammad Hafeez', '42101-3000025-9#115', '0311-3000115'), ('Naved Malik', '42101-3000026-1#116', '0311-3000116'),
('Omer Hussain', '42101-3000027-3#117', '0311-3000117'), ('Qasim Akram', '42101-3000028-5#118', '0311-3000118'),
('Rizwan Hussain', '42101-3000029-7#119', '0311-3000119'), ('Saud Shakeel', '42101-3000030-9#120', '0311-3000120'),
('Tabish Baig', '42101-3000031-1#121', '0312-3000121'), ('Usman Qadir', '42101-3000032-3#122', '0312-3000122'),
('Wahab Riaz Jr', '42101-3000033-5#123', '0312-3000123'), ('Yasir Ali', '42101-3000034-7#124', '0312-3000124'),
('Zahid Mahmood', '42101-3000035-9#125', '0312-3000125'), ('Aamer Jamal', '42101-3000036-1#126', '0312-3000126'),
('Akif Javed', '42101-3000037-3#127', '0312-3000127'), ('Ali Zaryab', '42101-3000038-5#128', '0312-3000128'),
('Azam Khan', '42101-3000039-7#129', '0312-3000129'), ('Bismillah Khan', '42101-3000040-9#130', '0312-3000130'),
('Fahad Munir', '42101-4000001-1#131', '0313-4000131'), ('Ghulam Mudassar', '42101-4000002-3#132', '0313-4000132'),
('Haris Sohail', '42101-4000003-5#133', '0313-4000133'), ('Iqbal Aslam', '42101-4000004-7#134', '0313-4000134'),
('Jalat Khan', '42101-4000005-9#135', '0313-4000135'), ('Kashif Bhatti', '42101-4000006-1#136', '0313-4000136'),
('Mir Hamza', '42101-4000007-3#137', '0313-4000137'), ('Nasir Nawaz', '42101-4000008-5#138', '0313-4000138'),
('Omair Yousuf', '42101-4000009-7#139', '0313-4000139'), ('Qaiser Abbas', '42101-4000010-9#140', '0313-4000140'),
('Ruman Raees', '42101-4000011-1#141', '0314-4000141'), ('Sahibzada Farhan', '42101-4000012-3#142', '0314-4000142'),
('Tahir H', '42101-4000013-5#143', '0314-4000143'), ('Usama Mir', '42101-4000014-7#144', '0314-4000144'),
('Waleed Ahmed', '42101-4000015-9#145', '0314-4000145'), ('Yasir Abbas', '42101-4000016-1#146', '0314-4000146'),
('Zaheer Khan', '42101-4000017-3#147', '0314-4000147'), ('Aaqib Javed', '42101-4000018-5#148', '0314-4000148'),
('Bilal Irshad', '42101-4000019-7#149', '0314-4000149'), ('Danish Kaneria', '42101-4000020-9#150', '0314-4000150'),
('Faizan Riaz', '42101-4000021-1#151', '0315-4000151'), ('Hamid Hassan', '42101-4000022-3#152', '0315-4000152'),
('Imran Safdar', '42101-4000023-5#153', '0315-4000153'), ('Kamran Hussain', '42101-4000024-7#154', '0315-4000154'),
('Mohammad Hasnain', '42101-4000025-9#155', '0315-4000155'), ('Najaf Shah', '42101-4000026-1#156', '0315-4000156'),
('Osama Bhatti', '42101-4000027-3#157', '0315-4000157'), ('Qasim Sheikh', '42101-4000028-5#158', '0315-4000158'),
('Riaz Hassan', '42101-4000029-7#159', '0315-4000159'), ('Salman Abbas', '42101-4000030-9#160', '0315-4000160'),
('Tanvir Hassan', '42101-4000031-1#161', '0316-4000161'), ('Umair Shafiq', '42101-4000032-3#162', '0316-4000162'),
('Wahaj Ali', '42101-4000033-5#163', '0316-4000163'), ('Yasir Khan', '42101-4000034-7#164', '0316-4000164'),
('Zeeshan Malik', '42101-4000035-9#165', '0316-4000165'), ('Ahmad Shahzad', '42101-4000036-1#166', '0316-4000166'),
('Bilal Khan', '42101-4000037-3#167', '0316-4000167'), ('Danish Latif', '42101-4000038-5#168', '0316-4000168'),
('Faraz Ahmed', '42101-4000039-7#169', '0316-4000169'), ('Hasnain Abbas', '42101-4000040-9#170', '0316-4000170'),
('Ikhlaq Ahmed', '42101-5000001-1#171', '0317-5000171'), ('Junaid Siddique', '42101-5000002-3#172', '0317-5000172'),
('Kashif Raza', '42101-5000003-5#173', '0317-5000173'), ('Mohammad Irfan', '42101-5000004-7#174', '0317-5000174'),
('Naved Yasin', '42101-5000005-9#175', '0317-5000175'), ('Omair Shah', '42101-5000006-1#176', '0317-5000176'),
('Qalandur Zaidi', '42101-5000007-3#177', '0317-5000177'), ('Raza Hasan', '42101-5000008-5#178', '0317-5000178'),
('Samiullah Khan', '42101-5000009-7#179', '0317-5000179'), ('Talha Ahmed', '42101-5000010-9#180', '0317-5000180'),
('Usman Salahuddin', '42101-5000011-1#181', '0318-5000181'), ('Wahab Ahmed', '42101-5000012-3#182', '0318-5000182'),
('Yasir Arafat Jr', '42101-5000013-5#183', '0318-5000183'), ('Zohaib Ahmed', '42101-5000014-7#184', '0318-5000184'),
('Abid Ali', '42101-5000015-9#185', '0318-5000185'), ('Bismillah Baig', '42101-5000016-1#186', '0318-5000186'),
('Daniyal Khan', '42101-5000017-3#187', '0318-5000187'), ('Farhan Zaman', '42101-5000018-5#188', '0318-5000188'),
('Humayun F', '42101-5000019-7#189', '0318-5000189'), ('Imamul Haq', '42101-5000020-9#190', '0318-5000190'),
('Javed Ali', '42101-5000021-1#191', '0319-5000191'), ('Kamran Ghulam', '42101-5000022-3#192', '0319-5000192'),
('Mohammad Abbas', '42101-5000023-5#193', '0319-5000193'), ('Noman Ali', '42101-5000024-7#194', '0319-5000194'),
('Omer Yousuf', '42101-5000025-9#195', '0319-5000195'), ('Qamar Ali', '42101-5000026-1#196', '0319-5000196'),
('Rehan Siddiq', '42101-5000027-3#197', '0319-5000197'), ('Said Ahmed', '42101-5000028-5#198', '0319-5000198'),
('Tariq Jameel', '42101-5000029-7#199', '0319-5000199'), ('Usman Khan', '42101-5000030-9#200', '0319-5000200'),
('Wahid Shah', '42101-5000031-1#201', '0320-5000201'), ('Yasir Mehmood', '42101-5000032-3#202', '0320-5000202'),
('Zahid Ali', '42101-5000033-5#203', '0320-5000203'), ('Ahmed Raza', '42101-5000034-7#204', '0320-5000204'),
('Bashir Ahmed', '42101-5000035-9#205', '0320-5000205'), ('Daniyal Aziz', '42101-5000036-1#206', '0320-5000206'),
('Fahad Nawaz', '42101-5000037-3#207', '0320-5000207'), ('Hamid Ali', '42101-5000038-5#208', '0320-5000208'),
('Imtiaz Shah', '42101-5000039-7#209', '0320-5000209'), ('Javaid Iqbal', '42101-5000040-9#210', '0320-5000210'),
('Khalil Khan', '42101-6000001-1#211', '0321-6000211'), ('Majid Hussain', '42101-6000002-3#212', '0321-6000212'),
('Naeem Shah', '42101-6000003-5#213', '0321-6000213'), ('Omar Akram', '42101-6000004-7#214', '0321-6000214'),
('Qadeer Ahmed', '42101-6000005-9#215', '0321-6000215'), ('Rafiq Khan', '42101-6000006-1#216', '0321-6000216'),
('Saleem Abbas', '42101-6000007-3#217', '0321-6000217'), ('Tariq Hussain', '42101-6000008-5#218', '0321-6000218'),
('Ubaid Ullah', '42101-6000009-7#219', '0321-6000219'), ('Wajid Ali', '42101-6000010-9#220', '0321-6000220'),
('Yaseen Malik', '42101-6000011-1#221', '0322-6000221'), ('Zahoor Ahmed', '42101-6000012-3#222', '0322-6000222'),
('Adeel Shah', '42101-6000013-5#223', '0322-6000223'), ('Bilal Hassan', '42101-6000014-7#224', '0322-6000224'),
('Dawood Shah', '42101-6000015-9#225', '0322-6000225'), ('Farrukh Zaman', '42101-6000016-1#226', '0322-6000226'),
('Habib Khan', '42101-6000017-3#227', '0322-6000227'), ('Irfan Ali', '42101-6000018-5#228', '0322-6000228'),
('Jamshed Ahmed', '42101-6000019-7#229', '0322-6000229'), ('Kamal Hussain', '42101-6000020-9#230', '0322-6000230'),
('Maqsood Ahmed', '42101-6000021-1#231', '0323-6000231'), ('Naveed Khan', '42101-6000022-3#232', '0323-6000232'),
('Owais Malik', '42101-6000023-5#233', '0323-6000233'), ('Pervaiz Ahmed', '42101-6000024-7#234', '0323-6000234'),
('Qaisar Ali', '42101-6000025-9#235', '0323-6000235'), ('Rasheed Khan', '42101-6000026-1#236', '0323-6000236'),
('Shahbaz Ahmed', '42101-6000027-3#237', '0323-6000237'), ('Tanveer Shah', '42101-6000028-5#238', '0323-6000238'),
('Umair Hassan', '42101-6000029-7#239', '0323-6000239'), ('Wasi Khan', '42101-6000030-9#240', '0323-6000240'),
('Yawar Ali', '42101-6000031-1#241', '0324-6000241'), ('Zubair Ahmed', '42101-6000032-3#242', '0324-6000242'),
('Afzaal Shah', '42101-6000033-5#243', '0324-6000243'), ('Basharat Ali', '42101-6000034-7#244', '0324-6000244'),
('Daud Khan', '42101-6000035-9#245', '0324-6000245'), ('Fawad Ahmed', '42101-6000036-1#246', '0324-6000246'),
('Hanif Shah', '42101-6000037-3#247', '0324-6000247'), ('Iqbal Shah', '42101-6000038-5#248', '0324-6000248'),
('Jameel Ahmed', '42101-6000039-7#249', '0324-6000249'), ('Kaleem Ullah', '42101-6000040-9#250', '0324-6000250');

-- Assignments: 1:1 mapping for today
-- Match drivers to buses based on their sequential IDs (driver 1 -> bus 1, driver 2 -> bus 2, etc.)
-- CROSS JOIN is used to allow matching every driver to every bus, but the WHERE clause ensures only pairs with the same ID are selected (1:1 mapping).
-- Only drivers and buses with IDs 1 to 250 are assigned (assuming IDs are sequential and start at 1).
INSERT INTO drivers_assignments (driver_id, bus_id, start_time, end_time) 
SELECT 
  -- Assign driver to bus with same ID
    d.driver_id, 
    b.bus_id, 
  -- Set assignment start time to today 07:00
    CONCAT(CURDATE(), ' 07:00:00') AS start_time, 
  -- Set assignment end time to today 22:00
    CONCAT(CURDATE(), ' 22:00:00') AS end_time
FROM drivers d
CROSS JOIN buses b
-- CROSS JOIN creates all possible driver-bus pairs; WHERE filters to 1:1 mapping
WHERE d.driver_id = b.bus_id
  AND d.driver_id <= 250
LIMIT 250;